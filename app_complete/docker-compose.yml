services:
  app_workout:
    build : .
    volumes:
      - ./:/app
    restart: always
    command: [ "python" , "/app/manage.py" , "runserver"  , "0.0.0.0:8000" ]

  nginx:
    build:
      context: ./nginx
    ports:
      - "80:80"
      - "443:443"
    depends_on:
      - app_workout

  mysql_workout:
    image: mysql
    environment:
      MYSQL_ROOT_PASSWORD: workout
      MYSQL_DATABASE: webapp_project
    restart: always
    volumes:
      - mysql_db:/var/lib/mysql

  phpmyadmin:
    image: phpmyadmin/phpmyadmin
    environment:
      # PMA_HOST: mysql_workout
      PMA_HOST: 54.169.211.200
      PMA_PORT: 3306
      MYSQL_ROOT_PASSWORD: workout
    ports:
      - 18001:80

volumes:
  mysql_db: